Add-Type @"
using System;
using System.Runtime.InteropServices;
public class Keyboard {
    [DllImport("user32.dll", SetLastError = true)]
    public static extern void keybd_event(byte bVk, byte bScan, int dwFlags, int dwExtraInfo);
}
"@

# 0x10 = VK_SHIFT
$VK_SHIFT = 0x10
$KEYEVENTF_KEYUP = 0x0002

while ($true) {
    # Appui sur SHIFT
    [Keyboard]::keybd_event($VK_SHIFT, 0, 0, 0)
    Start-Sleep -Milliseconds 50
    # RelÃ¢chement de SHIFT
    [Keyboard]::keybd_event($VK_SHIFT, 0, $KEYEVENTF_KEYUP, 0)

    # Attente 60 secondes
    Start-Sleep -Seconds 60
}
Enregistre le fichier en .ps1, par exemple :
anti_veille_clavier.ps1

Clique droit dessus â†’ ExÃ©cuter avec PowerShell

Tant que la fenÃªtre PowerShell reste ouverte, le script tourne.

ğŸ‘‰ Tu peux changer lâ€™intervalle en modifiant 60 (secondes) Ã  la fin.

âš™ï¸ Si Ã§a ne marche toujours pas
VÃ©rifie ces points (rapide) :

1ï¸âƒ£ PowerShell a le droit dâ€™exÃ©cuter le script ?
Ouvre PowerShell en admin, puis tape :

powershell
Copier le code
Get-ExecutionPolicy
Si tu vois Restricted, les scripts sont bloquÃ©s.

Dans ce cas, lance ton script comme Ã§a (sans changer la politique globale) :

powershell
Copier le code
powershell.exe -ExecutionPolicy Bypass -File "C:\Chemin\vers\anti_veille_clavier.ps1"
(en adaptant le chemin Ã©videmment).

2ï¸âƒ£ Est-ce que la politique de ton entreprise force le verrouillage ?
Dans certains environnements pro, mÃªme avec de lâ€™activitÃ© souris/clavier, une GPO impose un verrouillage aprÃ¨s X minutes.
Si câ€™est le cas, aucun script cÃ´tÃ© utilisateur ne pourra contourner la rÃ¨gle : câ€™est gÃ©rÃ© cÃ´tÃ© serveur / domaine.

ğŸ§© Si tu veux, je peux aussi :
Te faire un .vbs (double clic, pas de fenÃªtre visible).

Ou un script AutoHotkey encore plus discret si tu peux installer un petit outil.

Dis-moi juste ce que tu prÃ©fÃ¨res (sans rien installer / avec AutoHotkey) et je tâ€™Ã©cris la version prÃªte Ã  lâ€™emploi ğŸ‘













ChatGPT peut commettre des erreurs. Il est recommandÃ© de vÃ©rifier les informations importantes. Voir les prÃ©fÃ©rences en 
